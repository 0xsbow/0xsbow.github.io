<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Android Application Penetration Testing: Complete Methodology Guide</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --accent-primary: #58a6ff;
            --accent-secondary: #1f6feb;
            --border-color: #30363d;
            --success: #3fb950;
            --warning: #d29922;
            --danger: #f85149;
            --code-bg: #161b22;
            --mobile-accent: #3a86ff;
        }

        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f6f8fa;
            --bg-tertiary: #eaeef2;
            --text-primary: #24292f;
            --text-secondary: #57606a;
            --accent-primary: #0969da;
            --accent-secondary: #0550ae;
            --border-color: #d0d7de;
            --success: #1a7f37;
            --warning: #9a6700;
            --danger: #cf222e;
            --code-bg: #f6f8fa;
            --mobile-accent: #0969da;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.8;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .back-link {
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .theme-toggle {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theme-toggle:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
        }

        .post-header {
            margin-bottom: 50px;
        }

        .post-category {
            display: inline-block;
            padding: 6px 14px;
            background: var(--mobile-accent);
            color: white;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .post-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .post-meta {
            display: flex;
            gap: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .post-content {
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .post-content h2 {
            font-size: 1.8rem;
            margin: 40px 0 20px 0;
            color: var(--text-primary);
        }

        .post-content h3 {
            font-size: 1.4rem;
            margin: 30px 0 15px 0;
            color: var(--text-primary);
        }

        .post-content h4 {
            font-size: 1.1rem;
            margin: 20px 0 10px 0;
            color: var(--text-primary);
        }

        .post-content p {
            margin-bottom: 20px;
            color: var(--text-secondary);
        }

        .post-content ul, .post-content ol {
            margin: 20px 0;
            padding-left: 30px;
        }

        .post-content li {
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .post-content code {
            background: var(--code-bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: var(--accent-primary);
        }

        .post-content pre {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .post-content pre code {
            background: transparent;
            padding: 0;
            color: var(--text-primary);
            display: block;
        }

        .info-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--accent-primary);
            padding: 20px;
            margin: 30px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--warning);
            padding: 20px;
            margin: 30px 0;
            border-radius: 4px;
        }

        .danger-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--danger);
            padding: 20px;
            margin: 30px 0;
            border-radius: 4px;
        }

        .success-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--success);
            padding: 20px;
            margin: 30px 0;
            border-radius: 4px;
        }

        .info-box h4, .warning-box h4, .danger-box h4, .success-box h4 {
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .tools-table {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .tools-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .tools-table th {
            background: var(--bg-tertiary);
            padding: 15px;
            text-align: left;
            color: var(--text-primary);
            font-weight: 600;
            border-bottom: 2px solid var(--border-color);
        }

        .tools-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .tools-table tr:hover {
            background: var(--bg-tertiary);
        }

        footer {
            margin-top: 80px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .post-title {
                font-size: 2rem;
            }

            .post-content h2 {
                font-size: 1.5rem;
            }

            .post-content h3 {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <a href="../index.html" class="back-link">‚Üê Back to Blog</a>
            <button class="theme-toggle" onclick="toggleTheme()">
                <span id="theme-icon">‚òÄÔ∏è</span>
                <span id="theme-text">Light Mode</span>
            </button>
        </div>

        <article>
            <header class="post-header">
                <span class="post-category">MOBILE SECURITY</span>
                <h1 class="post-title">Android Application Penetration Testing: Complete Methodology Guide</h1>
                <div class="post-meta">
                    <span>Published: Dec, 2025</span>
                </div>
            </header>

            <div class="post-content">
                <p>Android application penetration testing is a comprehensive security evaluation process that identifies, exploits, and documents vulnerabilities in Android apps, APIs, and backend systems. With over 3 billion active Android devices worldwide and a constantly evolving threat landscape, Android security testing has become critical for developers, security professionals, and organizations. This guide provides a complete methodology covering tools, techniques, and real-world exploitation strategies for SSL pinning bypass, root detection evasion, insecure data storage exploitation, and more.</p>

                <h2>Understanding Android Security Fundamentals</h2>

                <h3>Android Application Architecture</h3>
                <p>Android applications consist of several key components that testers must understand:</p>

                <ul>
                    <li><strong>Activities:</strong> UI screens that users interact with</li>
                    <li><strong>Services:</strong> Background processes running without UI</li>
                    <li><strong>Broadcast Receivers:</strong> Listen for system or app-specific broadcasts</li>
                    <li><strong>Content Providers:</strong> Share data between apps and processes</li>
                    <li><strong>Intent Filters:</strong> Define how components communicate</li>
                </ul>

                <h3>Android Security Layers</h3>
                <pre><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Application Layer (Apps/APK)       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Android Framework (Java API)       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Native Libraries (C/C++)           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Linux Kernel & SELinux             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Hardware (TEE, Secure Boot)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code></pre>

                <h2>Required Hardware and Testing Environment Setup</h2>

                <h3>Hardware Requirements</h3>
                <div class="tools-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Specification</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Testing Device</strong></td>
                                <td>Physical Android Phone (Pixel/Samsung recommended)</td>
                                <td>Real-world testing, hardware-based security testing</td>
                            </tr>
                            <tr>
                                <td><strong>Emulator</strong></td>
                                <td>Genymotion or Android Studio Emulator</td>
                                <td>Rapid testing, root access, snapshots</td>
                            </tr>
                            <tr>
                                <td><strong>Host Machine</strong></td>
                                <td>4+ cores, 8GB+ RAM, 100GB+ SSD</td>
                                <td>Running tools, reverse engineering, analysis</td>
                            </tr>
                            <tr>
                                <td><strong>Network</strong></td>
                                <td>Isolated testing network with proxy capability</td>
                                <td>Man-in-the-middle (MITM) testing</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Lab Setup Checklist</h3>
                <pre><code>‚úì Rooted Android device or Genymotion emulator
‚úì USB debugging enabled on device
‚úì Burp Suite Professional/Community running as proxy
‚úì Frida server running on device
‚úì MobSF instance for automated analysis
‚úì Isolated testing network (not connected to production)
‚úì Test accounts with varying permission levels
‚úì ADB properly configured and working
‚úì Java JDK 8+ installed
‚úì Python 3.8+ installed for scripting</code></pre>

                <h2>Essential Penetration Testing Tools</h2>

                <div class="tools-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Tool Name</th>
                                <th>Primary Use</th>
                                <th>Cost</th>
                                <th>Key Capabilities</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>MobSF</strong></td>
                                <td>Automated Static & Dynamic Analysis</td>
                                <td>Free</td>
                                <td>APK analysis, vulnerability scoring, OWASP mapping, Frida integration</td>
                            </tr>
                            <tr>
                                <td><strong>Frida</strong></td>
                                <td>Runtime Instrumentation & Hooking</td>
                                <td>Free</td>
                                <td>SSL pinning bypass, root detection bypass, method hooking</td>
                            </tr>
                            <tr>
                                <td><strong>Burp Suite Pro</strong></td>
                                <td>MITM Proxy & API Testing</td>
                                <td>Paid (~$500/yr)</td>
                                <td>Traffic interception, request manipulation, scanner</td>
                            </tr>
                            <tr>
                                <td><strong>JADX</strong></td>
                                <td>APK Decompilation & Code Review</td>
                                <td>Free</td>
                                <td>Java source recovery, method search, obfuscation detection</td>
                            </tr>
                            <tr>
                                <td><strong>APKTool</strong></td>
                                <td>APK Reverse Engineering & Repackaging</td>
                                <td>Free</td>
                                <td>Resource extraction, manifest editing, smali modification</td>
                            </tr>
                            <tr>
                                <td><strong>Drozer</strong></td>
                                <td>Android Component Testing</td>
                                <td>Free</td>
                                <td>Activity enumeration, intent fuzzing, provider exploration</td>
                            </tr>
                            <tr>
                                <td><strong>Objection</strong></td>
                                <td>Runtime Mobile Exploration</td>
                                <td>Free</td>
                                <td>SSL pinning bypass, root detection bypass, file system access</td>
                            </tr>
                            <tr>
                                <td><strong>Android Debug Bridge (ADB)</strong></td>
                                <td>Device Communication & Control</td>
                                <td>Free</td>
                                <td>APK install, logcat monitoring, shell access, file transfer</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h2>Android Penetration Testing Methodology</h2>

                <h3>Phase 1: Reconnaissance & Information Gathering</h3>

                <h4>Static APK Analysis</h4>
                <p>Extract and analyze APK structure without running the application:</p>

                <pre><code># Extract APK file
adb shell pm path com.example.app
adb pull /path/to/app.apk

# Analyze APK with MobSF
# Upload to MobSF web interface or CLI:
python manage.py api --static com.example.app-1.0.apk

# Decompile with JADX
jadx -d output_dir com.example.app.apk

# Extract with APKTool
apktool d com.example.app.apk -o extracted_app</code></pre>

                <h4>Manifest Analysis</h4>
                <pre><code># Review AndroidManifest.xml for:
# 1. Exported components (activities, services, receivers, providers)
# 2. Dangerous permissions (INTERNET, READ_CONTACTS, CAMERA, etc.)
# 3. Intent filters and deeplinks
# 4. Min/Target SDK versions
# 5. Debuggable flag

# Check for debuggable apps:
adb shell am dump-config | grep debuggable
adb shell getprop ro.debuggable</code></pre>

                <h4>Network Analysis</h4>
                <pre><code># Identify hardcoded URLs and API endpoints
grep -r "http://" extracted_app/smali
grep -r "https://" extracted_app/smali
grep -r "api\." extracted_app/smali

# Analyze network configuration
cat extracted_app/res/xml/network_security_config.xml</code></pre>

                <h3>Phase 2: Dynamic Analysis & Runtime Testing</h3>

                <h4>Setting Up Proxy Interception</h4>
                <pre><code># 1. Start Burp Suite and configure proxy
# Proxy > Options > Add proxy listener (127.0.0.1:8080)

# 2. Export Burp Certificate
# Proxy > Options > Import/Export > Export CA certificate as DER
# Convert DER to PEM for Android:
openssl x509 -inform DER -in burp.der -out burp.pem

# 3. Install certificate on device
adb push burp.pem /sdcard/
adb shell
  cp /sdcard/burp.pem /system/etc/security/cacerts/
  chmod 644 /system/etc/security/cacerts/burp.pem
  
# OR for non-rooted devices (Android 11+):
# Use Network Security Configuration modification

# 4. Configure proxy on device
adb shell settings put global http_proxy "127.0.0.1:8080"

# 5. Verify in Burp Suite
# Traffic should now be intercepted</code></pre>

                <h3>Phase 3: SSL Pinning Bypass Techniques</h3>

                <h4>Understanding SSL Pinning</h4>
                <p>SSL Pinning is a security mechanism where apps validate not just the SSL certificate chain, but also verify that the certificate matches a pre-configured hash or public key embedded in the app. This prevents MITM attacks even if an attacker has a valid certificate from a compromised CA.</p>

                <h4>Method 1: Frida Script-Based Bypass (Most Effective)</h4>
                <pre><code>// Save as ssl_bypass.js
Java.perform(function() {
    var TrustManager = Java.use("com.android.org.conscrypt.TrustManagerImpl");
    var X509TrustManager = Java.use("javax.net.ssl.X509TrustManager");
    
    TrustManager.$init.overload('java.security.KeyStore').implementation = function(ks) {
        console.log("[*] TrustManager initialized");
        return this.$init(ks);
    };
    
    X509TrustManager.checkServerTrusted.overload('[Ljava.security.cert.X509Certificate;', 'java.lang.String').implementation = function(chain, authType) {
        console.log("[*] checkServerTrusted() called, bypassing...");
        return;
    };
    
    // OkHttp3 pinning bypass
    var OkHttpClient = Java.use("okhttp3.OkHttpClient");
    OkHttpClient.newBuilder.overload().implementation = function() {
        var client = this.newBuilder();
        console.log("[*] OkHttpClient created");
        return client;
    };
});

# Execute with Frida:
frida -U -f com.example.app -l ssl_bypass.js --no-pause</code></pre>

                <h4>Method 2: Objection Automated Bypass</h4>
                <pre><code># Install and run Objection
objection --gadget com.example.app explore

# Inside Objection prompt:
android sslpinning disable

# This automatically patches the app to bypass SSL pinning
# Objection handles common implementations (OkHttp, Retrofit, etc.)</code></pre>

                <h4>Method 3: Manual APKTool Modification</h4>
                <pre><code># 1. Decompile APK
apktool d com.example.app.apk -o app_src

# 2. Find SSL pinning logic (search for common patterns)
grep -r "TrustManager" app_src/smali
grep -r "checkServerTrusted" app_src/smali
grep -r "CertificatePinner" app_src/smali

# 3. Edit the relevant .smali file to bypass checks
# Find methods that verify certificates and modify them to return immediately

# 4. Recompile APK
apktool b app_src -o modified.apk

# 5. Sign the APK (with debug key)
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 \
  -keystore ~/.android/debug.keystore -storepass android \
  -keypass android modified.apk androiddebugkey

# 6. Install modified APK
adb install -r modified.apk</code></pre>

                <h3>Phase 4: Root Detection Bypass</h3>

                <h4>Understanding Root Detection</h4>
                <p>Root detection mechanisms check for indicators of a rooted device:</p>
                <ul>
                    <li>Presence of su binary or Magisk</li>
                    <li>Xposed Framework detection</li>
                    <li>Bootloader unlock status</li>
                    <li>System property modifications</li>
                    <li>Emulator detection</li>
                </ul>

                <h4>Method 1: Frida Root Detection Bypass</h4>
                <pre><code>// Save as root_bypass.js
Java.perform(function() {
    var Runtime = Java.use("java.lang.Runtime");
    var ProcessBuilder = Java.use("java.lang.ProcessBuilder");
    
    // Bypass su command execution
    Runtime.getRuntime.overload('[Ljava.lang.String;').implementation = function(commands) {
        console.log("[*] Runtime.exec() called with: " + commands);
        return this.getRuntime(commands);
    };
    
    // Bypass build.prop checks
    var System = Java.use("java.lang.System");
    var SystemProperties = Java.use("android.os.SystemProperties");
    
    SystemProperties.get.overload('java.lang.String').implementation = function(key) {
        if (key.includes("ro.debuggable")) {
            console.log("[*] Spoofing ro.debuggable=0");
            return "0";
        }
        return this.get(key);
    };
    
    // Bypass Magisk detection
    var File = Java.use("java.io.File");
    var original_exists = File.exists;
    
    File.exists.implementation = function() {
        var path = this.getAbsolutePath();
        if (path.includes("magisk") || path.includes("su")) {
            console.log("[*] Blocked check for: " + path);
            return false;
        }
        return original_exists.call(this);
    };
});

# Execute:
frida -U -f com.example.app -l root_bypass.js --no-pause</code></pre>

                <h4>Method 2: Magisk Module Masking</h4>
                <pre><code># Install Magisk on device
# Install Magisk Hide module
# In Magisk app: Settings > Magisk Hide > Select target app

# This hides root from the selected app completely
# More effective than Frida scripts for apps with sophisticated checks</code></pre>

                <h3>Phase 5: Insecure Data Storage Exploitation</h3>

                <h4>Common Storage Vulnerabilities</h4>
                <pre><code># 1. Plaintext credentials in SharedPreferences
adb shell
  cat /data/data/com.example.app/shared_prefs/*.xml
  
# 2. World-readable files
adb shell ls -la /data/data/com.example.app/

# 3. Unencrypted databases
adb pull /data/data/com.example.app/databases/app.db
sqlite3 app.db "SELECT * FROM users;"

# 4. Cache files with sensitive data
adb shell cat /data/data/com.example.app/cache/*

# 5. Temporary files
find /sdcard/ -name "*.tmp" 2>/dev/null | xargs cat</code></pre>

                <h4>Extracting Stored Credentials</h4>
                <pre><code># Using Objection to access file system
objection --gadget com.example.app explore

# Inside Objection:
file cwd  # Current working directory
file ls   # List files
file cat /data/data/com.example.app/shared_prefs/settings.xml

# Extract and decrypt databases
file download /data/data/com.example.app/databases/app.db app.db
# Open locally with SQLite browser</code></pre>

                <h3>Phase 6: API and Network Security Testing</h3>

                <h4>API Vulnerability Testing</h4>
                <pre><code># 1. Intercept API calls with Burp Suite
# Configure device proxy, capture all requests

# 2. Test for IDOR (Insecure Direct Object Reference)
# Intercept request: GET /api/users/123/profile
# Modify ID: GET /api/users/456/profile
# If you access another user's data ‚Üí IDOR vulnerability

# 3. Test for authentication bypass
# Remove authorization headers
# Use expired tokens
# Modify token claims

# 4. Test for injection vulnerabilities
# Inject payloads in API parameters:
  {"username": "admin' --", "password": "anything"}
  {"user_id": "1; DROP TABLE users--"}
  
# 5. Analyze API responses for sensitive data leakage
# Look for: tokens, session IDs, personal info, internal paths</code></pre>

                <h3>Phase 7: Permission and Component Analysis</h3>

                <h4>Exported Component Testing</h4>
                <pre><code># List exported activities
drozer shell
  run app.activity.info -u com.example.app
  
# List exported services
  run app.service.info -u com.example.app
  
# List exported content providers
  run app.provider.info -u com.example.app
  
# Test intent injection
adb shell am start -n com.example.app/.vulnerable.Activity

# Exploit content providers
adb shell content query --uri content://com.example.app.provider/sensitive_data</code></pre>

                <h3>Phase 8: Deeplink and Intent Fuzzing</h3>

                <pre><code># Test custom deeplinks
adb shell am start -a android.intent.action.VIEW \
  -d "myapp://admin/dashboard"

# Fuzz intent filters
adb shell am start -a com.example.CUSTOM_ACTION \
  -d "content://com.example.app/admin"

# Intercept broadcasts
adb shell am broadcast -a com.EXAMPLE.ACTION \
  --es param "malicious_value"</code></pre>

                <h2>OWASP Mobile Top 10 Testing Checklist</h2>

                <h3>M1: Improper Credential Usage</h3>
                <ul>
                    <li>Test for hardcoded credentials in code</li>
                    <li>Verify secure credential storage (Keystore)</li>
                    <li>Test for credential exposure in logs</li>
                    <li>Verify token expiration and refresh mechanisms</li>
                </ul>

                <h3>M2: Inadequate Supply Chain Security</h3>
                <ul>
                    <li>Check for vulnerable dependencies</li>
                    <li>Verify library versions are up-to-date</li>
                    <li>Test third-party SDK security</li>
                </ul>

                <h3>M3: Insecure Authentication/Authorization</h3>
                <ul>
                    <li>Test for authentication bypass</li>
                    <li>Verify session management</li>
                    <li>Test privilege escalation paths</li>
                    <li>Verify authorization checks on all APIs</li>
                </ul>

                <h3>M4: Insecure Communication</h3>
                <ul>
                    <li>Verify SSL/TLS usage on all connections</li>
                    <li>Test for certificate pinning bypass</li>
                    <li>Check for HTTP usage</li>
                    <li>Test for MITM attack resistance</li>
                </ul>

                <h3>M5: Insecure Data Storage</h3>
                <ul>
                    <li>Test for unencrypted sensitive data</li>
                    <li>Check database encryption</li>
                    <li>Verify file permissions</li>
                    <li>Test for cached credentials</li>
                </ul>

                <h3>M6: Inadequate Privacy Controls</h3>
                <ul>
                    <li>Verify PII encryption</li>
                    <li>Test data retention policies</li>
                    <li>Check for unnecessary data collection</li>
                </ul>

                <h3>M7: Insufficient Input/Output Validation</h3>
                <ul>
                    <li>Test for SQL injection</li>
                    <li>Test for XSS in WebViews</li>
                    <li>Test for command injection</li>
                    <li>Verify input sanitization</li>
                </ul>

                <h3>M8: Insufficient Cryptography</h3>
                <ul>
                    <li>Verify strong algorithms (AES-256)</li>
                    <li>Check for weak hashing (MD5)</li>
                    <li>Test for hardcoded encryption keys</li>
                    <li>Verify random number generation</li>
                </ul>

                <h3>M9: Improper Reverse Engineering Protections</h3>
                <ul>
                    <li>Attempt to decompile and reverse engineer APK</li>
                    <li>Test for obfuscation effectiveness</li>
                    <li>Check for debuggable flag</li>
                    <li>Test for root detection mechanisms</li>
                </ul>

                <h3>M10: Extraneous Functionality</h3>
                <ul>
                    <li>Check for debug features in production</li>
                    <li>Test for hidden admin panels</li>
                    <li>Verify hidden activities are not accessible</li>
                    <li>Check for test code in release builds</li>
                </ul>

                <h2>MITRE ATT&CK for Android Testing</h2>

                <p>Align penetration testing with MITRE ATT&CK Mobile techniques:</p>

                <h3>Initial Access</h3>
                <ul>
                    <li><strong>T1444 Masquerade as Legitimate Application:</strong> Test app store protections</li>
                    <li><strong>T1476 Deliver Malicious App via Other Means:</strong> Test sideload restrictions</li>
                </ul>

                <h3>Persistence</h3>
                <ul>
                    <li><strong>T1398 Modify System Partition:</strong> Check for boot-time code execution</li>
                    <li><strong>T1541 Foreground Persistence:</strong> Verify app doesn't abuse foreground service</li>
                </ul>

                <h3>Defense Evasion</h3>
                <ul>
                    <li><strong>T1418 Application Discovery:</strong> Check if app enumeration is prevented</li>
                    <li><strong>T1406 Obfuscated Files or Information:</strong> Test code obfuscation bypasses</li>
                </ul>

                <h3>Credential Access</h3>
                <ul>
                    <li><strong>T1411 Input Injection:</strong> Test form inputs for injection attacks</li>
                    <li><strong>T1409 Stored Application Data:</strong> Analyze stored credentials</li>
                </ul>

                <h3>Discovery</h3>
                <ul>
                    <li><strong>T1418 Application Discovery:</strong> List installed apps</li>
                    <li><strong>T1426 System Information Discovery:</strong> Extract device information</li>
                </ul>

                <h3>Collection</h3>
                <ul>
                    <li><strong>T1533 Data from Local System:</strong> Extract app data</li>
                    <li><strong>T1412 Capture SMS Messages:</strong> Test SMS permission handling</li>
                </ul>

                <h2>Advanced Exploitation Techniques</h2>

                <h3>WebView Vulnerability Testing</h3>
                <pre><code># 1. Identify WebViews in app
grep -r "WebView" extracted_app/smali
grep -r "loadUrl" extracted_app/smali

# 2. Test for JavaScript enabled
# Check if WebView.getSettings().setJavaScriptEnabled(true)

# 3. Test for addJavascriptInterface vulnerabilities
grep -r "addJavascriptInterface" extracted_app/smali
# Exposed interfaces can be exploited by JavaScript

# 4. Test for insecure URLs
grep -r "file://" extracted_app/smali
# file:// URLs can access sensitive local files

# 5. Frida script to hook WebView
Java.perform(function() {
    var WebView = Java.use("android.webkit.WebView");
    var WebViewClient = Java.use("android.webkit.WebViewClient");
    
    WebView.loadUrl.overload('java.lang.String').implementation = function(url) {
        console.log("[*] WebView loading: " + url);
        return this.loadUrl(url);
    };
});</code></pre>

                <h3>File System Access Exploitation</h3>
                <pre><code># 1. Check file permissions
adb shell ls -laR /data/data/com.example.app/

# 2. Extract world-readable files
adb pull /data/data/com.example.app/app_specific/ local_copy/

# 3. Search for sensitive data in app cache
adb shell find /data/data/com.example.app/cache -type f | \
  while read file; do
    echo "=== $file ===";
    adb shell cat "$file";
  done</code></pre>

                <h3>Broadcast Receiver Exploitation</h3>
                <pre><code># 1. Identify exported broadcast receivers
adb shell dumpsys package com.example.app | grep -A20 "Receiver"

# 2. Trigger broadcasts
adb shell am broadcast -a com.example.CUSTOM_ACTION \
  --es sensitive_param "exploit_payload"

# 3. Listen for broadcasts
adb shell dumpsys package receivers | grep com.example</code></pre>

                <h2>Practical Exploitation Workflows</h2>

                <h3>Complete SSL Pinning Bypass Workflow</h3>
                <pre><code># Step 1: Prepare environment
adb devices
frida-ps -U

# Step 2: Create Frida script (ssl_bypass.js)
# [See SSL Pinning Bypass section above]

# Step 3: Inject into running process
frida -U -f com.example.app -l ssl_bypass.js --no-pause

# Step 4: Configure Burp as system proxy
# Device > Settings > Network > Proxy

# Step 5: Intercept traffic in Burp Suite
# Now all HTTPS traffic can be inspected despite pinning

# Step 6: Analyze and modify requests
# Burp Suite can now MITM all app traffic</code></pre>

                <h3>Complete Data Exfiltration Workflow</h3>
                <pre><code># Step 1: Identify storage locations
adb shell pm list packages | grep example
adb shell "ls -la /data/data/com.example.app/"

# Step 2: Extract all app data
adb backup -f app_backup.ab -apk com.example.app
abd shell "cp -r /data/data/com.example.app /sdcard/backup/"

# Step 3: Access databases
adb pull /data/data/com.example.app/databases/ ./databases/
sqlite3 ./databases/app.db ".dump" > data.sql

# Step 4: Extract SharedPreferences
adb pull /data/data/com.example.app/shared_prefs/ ./prefs/
cat ./prefs/*.xml

# Step 5: Analyze extracted data
grep -r "password\|token\|key\|secret" ./databases/ ./prefs/</code></pre>

                <h2>Detection Evasion and Stealth Techniques</h2>

                <h4>Avoiding Logging and Detection</h4>
                <pre><code># 1. Disable logging
adb shell setprop log.tag.* SUPPRESS

# 2. Hook logging mechanisms
// Frida script to suppress logs
Java.perform(function() {
    var Log = Java.use("android.util.Log");
    Log.d.overload('java.lang.String', 'java.lang.String').implementation = function() {
        return 0;
    };
});

# 3. Clear logs after testing
adb shell logcat -c

# 4. Disable crash reporting
adb shell pm disable com.google.android.gms/com.google.android.gms.stats.StatsService</code></pre>

                <h2>Post-Exploitation and Reporting</h2>

                <h3>Vulnerability Classification</h3>
                <div class="tools-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>CVSS Score</th>
                                <th>Definition</th>
                                <th>Remediation Timeline</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Critical</strong></td>
                                <td>9.0-10.0</td>
                                <td>Immediate remote code execution or complete data breach</td>
                                <td>24-48 hours</td>
                            </tr>
                            <tr>
                                <td><strong>High</strong></td>
                                <td>7.0-8.9</td>
                                <td>Significant security impact, privilege escalation, or data loss</td>
                                <td>1 week</td>
                            </tr>
                            <tr>
                                <td><strong>Medium</strong></td>
                                <td>4.0-6.9</td>
                                <td>Moderate impact, authentication bypass, or information disclosure</td>
                                <td>2-4 weeks</td>
                            </tr>
                            <tr>
                                <td><strong>Low</strong></td>
                                <td>0.1-3.9</td>
                                <td>Minor issues, limited impact</td>
                                <td>30 days</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Report Structure</h3>
                <ul>
                    <li><strong>Executive Summary:</strong> High-level overview for non-technical stakeholders</li>
                    <li><strong>Vulnerability Details:</strong> Each finding with CVSS, description, proof of concept, impact</li>
                    <li><strong>OWASP Mobile Top 10 Mapping:</strong> Show which OWASP issues were exploited</li>
                    <li><strong>Remediation Recommendations:</strong> Specific code-level fixes</li>
                    <li><strong>Security Best Practices:</strong> Guidance for secure Android development</li>
                    <li><strong>Testing Methodology:</strong> Document all tools and techniques used</li>
                </ul>

                <h2>Secure Android Development Guidelines</h2>

                <h3>Secure Data Storage</h3>
                <pre><code>// Use Android Keystore for sensitive data
KeyStore keyStore = KeyStore.getInstance("AndroidKeyStore");
keyStore.load(null);

KeyStore.SecretKeyEntry secretKeyEntry = 
  (KeyStore.SecretKeyEntry) keyStore.getEntry("key_alias", null);

// Encrypt SharedPreferences
EncryptedSharedPreferences.create(
  context,
  "encrypted_prefs",
  new MasterKey.Builder(context).setKeyScheme(MasterKey.KeyScheme.AES256_GCM).build(),
  EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,
  EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM
).edit();</code></pre>

                <h3>Secure Network Communication</h3>
                <pre><code>// Implement Certificate Pinning with OkHttp3
CertificatePinner certificatePinner = new CertificatePinner.Builder()
  .add("api.example.com", "sha256/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=")
  .build();

OkHttpClient client = new OkHttpClient.Builder()
  .certificatePinner(certificatePinner)
  .build();

// Enforce minimum TLS version
SSLContext sslContext = SSLContext.getInstance("TLSv1.2");
sslContext.init(null, null, null);

OkHttpClient secureClient = new OkHttpClient.Builder()
  .sslSocketFactory(sslContext.getSocketFactory(), trustManager)
  .build();</code></pre>

                <h3>Input Validation</h3>
                <pre><code>// Validate and sanitize all user input
public static String sanitizeInput(String input) {
    return input
      .replaceAll("[^a-zA-Z0-9 ]", "")
      .trim();
}

// Use proper prepared statements for database queries
SQLiteDatabase db = dbHelper.getWritableDatabase();
Cursor cursor = db.query(
  "users",
  null,
  "username=? AND password=?",
  new String[]{username, password},  // Parameterized
  null, null, null
);</code></pre>

                <h2>Tips and Tricks for Android Penetration Testers</h2>

                <h3>Efficiency Hacks</h3>
                <ul>
                    <li><strong>Create ADB alias:</strong> <code>alias adb='/path/to/adb'</code></li>
                    <li><strong>Monitor logs in real-time:</strong> <code>adb logcat | grep -i "example_app"</code></li>
                    <li><strong>Batch install APK:</strong> <code>for apk in *.apk; do adb install "$apk"; done</code></li>
                    <li><strong>Frida with timeout:</strong> <code>timeout 30 frida -U -f com.app -l hook.js</code></li>
                    <li><strong>Quick APK backup:</strong> <code>adb shell pm path com.app | cut -d: -f2 | xargs -I {} adb pull {}</code></li>
                </ul>

                <h3>Common Pitfalls to Avoid</h3>
                <ul>
                    <li>Testing without obtaining explicit written authorization</li>
                    <li>Modifying or deleting production user data</li>
                    <li>Testing on personal devices without isolation</li>
                    <li>Failing to document all activities and findings</li>
                    <li>Not considering the app's legitimate background processes when analyzing logs</li>
                    <li>Assuming SSL pinning is always implemented server-side</li>
                </ul>

                <h3>Pro Tips</h3>
                <ul>
                    <li>Use Genymotion emulator for consistent, reproducible testing environments</li>
                    <li>Frida is more reliable than manual patching for runtime testing</li>
                    <li>Always test on both real devices and emulators (different behaviors)</li>
                    <li>Combine MobSF automated scanning with manual code review for comprehensive assessment</li>
                    <li>Create reusable Frida scripts library for faster testing</li>
                    <li>Use AppInspect's Network Monitor for quick traffic analysis without Burp</li>
                </ul>

                <h2>Conclusion</h2>

                <p>Android application penetration testing requires a deep understanding of the platform's architecture, security mechanisms, and common vulnerabilities. By following the methodology outlined in this guide‚Äîfrom reconnaissance and dynamic analysis to SSL pinning bypass, root detection evasion, and data exfiltration‚Äîsecurity professionals can identify and remediate critical vulnerabilities before they reach production.</p>

                <p>The combination of automated tools like MobSF, runtime instrumentation with Frida, and manual code review creates a comprehensive testing approach. Always remember that the goal is to help organizations build more secure applications, not to cause harm. Test responsibly, document thoroughly, and maintain a strong ethical foundation in all your security work.</p>

                <p>Stay patched, stay vigilant, and keep learning‚Äîthe Android threat landscape evolves constantly.</p>
            </div>
        </article>

        <footer>
            <p>¬© 2025 SBOW Infosec. All research for educational purposes only.</p>
        </footer>
    </div>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'light') {
                html.removeAttribute('data-theme');
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light Mode';
                localStorage.setItem('theme', 'dark');
            } else {
                html.setAttribute('data-theme', 'light');
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark Mode';
                localStorage.setItem('theme', 'light');
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');
            
            if (savedTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark Mode';
            }
        });
    </script>
</body>
</html>
